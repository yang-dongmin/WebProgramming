# React Router 라우팅 가이드

## 라우팅이란?

웹 애플리케이션에서 라우팅이라는 개념은 사용자가 요청한 URL에 따라 알맞는 페이지를 보여주는 것을 의미한다. 웹 애플리케이션을 만들 때 프로젝트를 하나의 페이지로 구성할 수도 있고, 여러 페이지를 구성할 수도 있다.

예를 들어, 일정 관리 애플리케이션에서는 하나의 페이지로 충분할 수 있겠지만, 블로그를 만든다고 가정하면 여러 페이지로 구성이 되어있다.

- **글쓰기 페이지**: 새로운 포스트를 작성하는 페이지
- **포스트 목록 페이지**: 블로그에 작성된 여러 포스트들의 목록을 보여주는 페이지
- **포스트 읽기 페이지**: 하나의 포스트를 보여주는 페이지

이렇게 여러 페이지로 구성된 웹 애플리케이션을 만들 때 페이지 별로 컴포넌트들을 분리해가면서 프로젝트를 관리하기 위해 필요한 것이 바로 라우팅 시스템이다.

## SPA (Single Page Application)

싱글 페이지 애플리케이션이란, 한 개의 페이지로 이루어진 애플리케이션이다.

MPA는 사용자 인터랙션이 별로 없는 정적인 페이지들은 기존의 방식이 적합하지만, 사용자 인터랙션이 많고 다양한 정보를 제공하는 모던 웹 애플리케이션은 이 방식이 적합하지 않다.

HTML을 한번만 받아와서 웹 애플리케이션을 실행시킨 후에 그 이후에는 필요한 데이터만 받아와서 화면에 업데이트 해주는 것이 싱글 페이지 애플리케이션이다.

싱글 페이지 애플리케이션은 기술적으로는 한 페이지만 존재하는 것이지만, 사용자가 경험하기에는 여러 페이지가 존재하는 것 처럼 느낄 수 있다. 리액트 라우터와 같은 라우팅 시스템은 사용자의 브라우저 주소창의 경로에 따라 알맞는 페이지를 보여주는데, 이후 링크를 눌러서 다른 페이지로 이동하게 될 때 서버에 다른 페이지의 html을 새로 요청하는 것이 아니라, 브라우저의 History API를 사용하여 브라우저의 주소창의 값만 변경하고 기존에 페이지에 띄웠던 웹 애플리케이션을 그대로 유지하면서 라우팅 설정에 따라 또 다른 페이지를 보여주게 된다.

## React Router 적용 및 기본 사용법

### 프로젝트 생성 및 라이브러리 설치
- 페이지 만들고 이동해보기
- URL 파라미터와 쿼리스트링 사용해보기
- 중첩된 라우트 구현하기
- 리액트 라우터의 부가기능 사용해보기

### 프로젝트에 라우터 적용

`src/index.js` 파일에서 `react-router-dom`에 내장되어 있는 `BrowserRouter`라는 컴포넌트를 사용하여 감싸면 된다. 이 컴포넌트는 웹 애플리케이션에 HTML5의 History API를 사용하여 페이지를 새로 불러오지 않고도 주소를 변경하고 현재 주소의 경로에 관련된 정보를 리액트 컴포넌트에서 사용할 수 있도록 해 준다.

### Route 컴포넌트로 특정 경로에 원하는 컴포넌트 보여주기

사용자의 브라우저 주소 경로에 따라 원하는 컴포넌트를 보여주기 위해서 `Route`라는 컴포넌트를 통해 라우트 설정을 해주어야 한다.

Route 컴포넌트는 다음과 같이 사용한다:

```jsx
<Route path="주소규칙" element={보여 줄 컴포넌트 JSX} />
```

그리고, `Route` 컴포넌트는 `Routes` 컴포넌트 내부에서 사용한다.

### Link 컴포넌트를 사용하여 다른 페이지로 이동하는 링크 보여주기

`Link` 컴포넌트는 a 태그를 사용하긴 하지만, 페이지를 새로 불러오는 것을 막고 History API를 통해 브라우저 주소의 경로만 바꾸는 기능이 내장되어 있다.

Link 컴포넌트는 다음과 같이 사용한다:

```jsx
<Link to="경로">링크 이름</Link>
```

웹 페이지에서는 원래 링크를 보여줄 때 a 태그를 사용하는데, 리액트 라우터를 사용하는 프로젝트에서 a 태그를 바로 사용하면 안된다. 왜냐하면, a 태그를 클릭하여 페이지를 이동할 때 브라우저에서는 페이지를 새로 불러오게 되기 때문이다.

## URL 파라미터와 쿼리스트링

페이지 주소를 정의할 때 가끔은 유동적인 값을 사용해야 할 때도 있다.

- **URL 파라미터 예시**: `/profile/velopert`
- **쿼리스트링 예시**: `/articles?page=1&keyword=react`

URL 파라미터는 주소의 경로에 유동적인 값을 넣는 형태고, 쿼리 스트링은 주소의 뒷부분에 `?` 문자열 이후에 `key=value` 로 값을 정의하며 `&` 로 구분을 하는 형태다.

주로 URL 파라미터는 ID 또는 이름을 사용하여 특정 데이터를 조회할 때 사용하고, 쿼리스트링(Querystring)은 키워드 검색, 페이지네이션, 정렬 방식 등 데이터 조회에 필요한 옵션을 전달할 때 사용한다.

### URL 파라미터

URL 파라미터는 `useParams`라는 Hook을 사용하여 객체 형태로 조회할 수 있다. URL 파라미터의 이름은 라우트 설정을 할 때 Route 컴포넌트의 path props를 통하여 설정한다.

URL 파라미터는 `/profiles/:username`과 같이 경로에 `:` 를 사용하여 설정한다.

만약 URL 파라미터가 여러 개인 경우엔 `/profiles/:username/:field` 와 같은 형태로 설정한다.

### 쿼리스트링

쿼리스트링을 사용할 때는 URL 파라미터와 달리 Route 컴포넌트를 사용할 때 별도로 설정해야되는 것은 없다.

#### useLocation Hook

`useLocation`이라는 Hook은 location 객체를 반환하며 이 객체는 현재 사용자가 보고있는 페이지의 정보를 지니고 있다. 이 객체에는 다음과 같은 값들이 있다:

- **pathname**: 현재 주소의 경로 (쿼리스트링 제외)
- **search**: 맨 앞의 `?` 문자 포함한 쿼리스트링 값
- **hash**: 주소의 `#` 문자열 뒤의 값 (주로 History API 가 지원되지 않는 구형 브라우저에서 클라이언트 라우팅을 사용할 때 쓰는 해시 라우터에서 사용)
- **state**: 페이지로 이동할때 임의로 넣을 수 있는 상태 값
- **key**: location 객체의 고유 값, 초기에는 default 이며 페이지가 변경될 때마다 고유의 값이 생성됨

쿼리스트링은 `location.search` 값을 통해 조회를 할 수 있다.

#### useSearchParams Hook

리액트 라우터에서는 v6부터 `useSearchParams`라는 Hook을 통해서 쿼리스트링을 쉽게 다룰 수 있다.

`useSearchParams`는 배열 타입의 값을 반환하며, 첫번째 원소는 쿼리 파라미터를 조회하거나 수정하는 메서드들이 담긴 객체를 반환한다.

- `get` 메서드를 통해 특정 쿼리 파라미터를 조회할 수 있음
- `set` 메서드를 통해 특정 쿼리 파라미터를 업데이트 할 수 있음
- 만약 조회 시에 쿼리 파라미터가 존재하지 않는다면 `null`로 조회됨

두번째 원소는 쿼리 파라미터를 객체 형태로 업데이트할 수 있는 함수를 반환한다.

**주의사항**: 쿼리 파라미터를 사용할 때 주의할 점은 쿼리 파라미터를 조회할 때 값은 무조건 문자열 타입이라는 것이다. 즉, `true` 또는 `false` 값을 넣게 된다면 값을 비교할 때 꼭 `'true'` 와 같이 따옴표로 감싸서 비교를 해야 하고, 숫자를 다루게 된다면 `parseInt`를 사용하여 숫자 타입으로 변환을 해야 한다.

## useNavigate

`useNavigate`는 Link 컴포넌트를 사용하지 않고 다른 페이지로 이동을 해야 하는 상황에 사용하는 Hook이다.

`navigate` 함수를 사용할 때 파라미터가 숫자 타입이라면 앞으로 가거나, 뒤로 간다:

- `navigate(-1)`: 한 번 뒤로 가기
- `navigate(-2)`: 두 번 뒤로 가기
- `navigate(1)`: 앞으로 한 번 가기 (뒤로 가기를 한번 한 상태여야 함)

다른 페이지로 이동을 할 때 `replace` 라는 옵션이 있는데, 이 옵션을 사용하면 페이지를 이동할 때 현재 페이지를 페이지 기록에 남기지 않는다.

## Navigate 컴포넌트

`Navigate` 컴포넌트는 컴포넌트를 화면에 보여주는 순간 다른 페이지로 이동을 하고 싶을 때 사용하는 컴포넌트다. 즉, 페이지를 리다이렉트 하고 싶을 때 사용한다.